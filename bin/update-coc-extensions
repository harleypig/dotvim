#!/usr/bin/env bash

## script that creates a file `install-coc-extensions.vim`
## Use this command to install it (coc.nvim plugin required):
##        vim -c 'source install-coc-extensions.vim'

# Extract the list of extensions from package.json
EXTENSIONS=$(jq -r '.dependencies | keys | .[]' ~/.config/coc/extensions/package.json | sed "s/.*/'&',/")

echo "let g:coc_global_extensions = [" > install-coc-extensions.vim
echo "$EXTENSIONS" >> install-coc-extensions.vim
echo "]" >> install-coc-extensions.vim

# Update .vimrc with the new list of extensions, ensuring proper escaping of the sed delimiter
sed -i.bak -e "/let g:coc_global_extensions = \[/,/\]/c\let g:coc_global_extensions = [\n$EXTENSIONS\n]" .vimrc
